<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.its.modules.module.dao.VillageLinerecommoduleDao">

  <sql id="villageLinerecommoduleColumns">
    a.id AS "id",
    a.village_line_id AS "villageLineId",
    a.recom_position AS "recomPosition",
    a.sort_num AS "sortNum",
    a.recom_type AS "recomType",
    a.recom_module_id AS "recomModuleId",
    a.recom_business_id AS "recomBusinessId",
    a.describes AS "describes",
    a.pic_url AS "picUrl",
    a.create_by AS "createBy.id",
    a.create_date AS "createDate",
    a.update_by AS "updateBy.id",
    a.update_date AS "updateDate",
    a.remarks AS "remarks",
    a.del_flag AS "delFlag"
  </sql>

  <sql id="villageLinerecommoduleJoins">
  </sql>

  <select id="get" resultType="VillageLinerecommodule">
    SELECT
    <include refid="villageLinerecommoduleColumns" />
    FROM village_linerecommodule a
    <include refid="villageLinerecommoduleJoins" />
    WHERE a.id = #{id}
  </select>

  <select id="findList" resultType="VillageLinerecommodule">
    SELECT
    <include refid="villageLinerecommoduleColumns" />
    FROM village_linerecommodule a
    <include refid="villageLinerecommoduleJoins" />
    <where>
      a.del_flag = #{DEL_FLAG_NORMAL}
    </where>
    <choose>
      <when test="page !=null and page.orderBy != null and page.orderBy != ''">
        ORDER BY ${page.orderBy}
      </when>
      <otherwise>
        ORDER BY a.sort_num DESC
      </otherwise>
    </choose>
  </select>

  <select id="findAllList" resultType="VillageLinerecommodule">
    SELECT
    <include refid="villageLinerecommoduleColumns" />
    FROM village_linerecommodule a
    <include refid="villageLinerecommoduleJoins" />
    <where>
      a.del_flag = #{DEL_FLAG_NORMAL}
    </where>
    <choose>
      <when test="page !=null and page.orderBy != null and page.orderBy != ''">
        ORDER BY ${page.orderBy}
      </when>
      <otherwise>
        ORDER BY a.sort_num DESC
      </otherwise>
    </choose>
  </select>

  <insert id="insert">
    INSERT INTO village_linerecommodule(
    id,
    village_line_id,
    recom_position,
    sort_num,
    recom_type,
    recom_module_id,
    recom_business_id,
    describes,
    pic_url,
    create_by,
    create_date,
    update_by,
    update_date,
    remarks,
    del_flag
    ) VALUES (
    #{id},
    #{villageLineId},
    #{recomPosition},
    #{sortNum},
    #{recomType},
    #{recomModuleId},
    #{recomBusinessId},
    #{describes},
    #{picUrl},
    #{createBy.id},
    #{createDate},
    #{updateBy.id},
    #{updateDate},
    #{remarks},
    #{delFlag}
    )
  </insert>

  <update id="update">
    UPDATE village_linerecommodule SET
    village_line_id = #{villageLineId},
    recom_position = #{recomPosition},
    sort_num = #{sortNum},
    recom_type = #{recomType},
    recom_module_id = #{recomModuleId},
    recom_business_id = #{recomBusinessId},
    describes = #{describes},
    pic_url = #{picUrl},
    update_by = #{updateBy.id},
    update_date = #{updateDate},
    remarks = #{remarks}
    WHERE id = #{id}
  </update>

  <update id="delete">
    UPDATE village_linerecommodule SET
    del_flag = #{DEL_FLAG_DELETE}
    WHERE id = #{id}
  </update>
  <!-- 通过楼盘线删除推荐模块信息  add by zhujiao-->
  <delete id="deleteByLine">
    DELETE FROM village_linerecommodule WHERE village_line_id = #{villageLineId}
  </delete>
   <!-- 通过楼盘线获取推荐模块列表  add by zhujiao -->
  <select id="getRecomModuleList" resultType="VillageLinerecommodule">
    SELECT
    <include refid="villageLinerecommoduleColumns" />
    FROM village_linerecommodule a
    <include refid="villageLinerecommoduleJoins" />
    <where>
      a.del_flag = '0' AND a.village_line_id = #{villageLineId}
    </where>
     ORDER BY a.sort_num ASC
  </select>

</mapper>