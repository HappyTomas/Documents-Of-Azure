<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.its.modules.forward.dao.SocialForwardDao">
    
	<sql id="socialForwardColumns">
		a.id AS "id",
		a.userid AS "userid",
		a.subjectid AS "subjectid",
		a.tag AS "tag",
		a.reason AS "reason",
		a.visrange AS "visrange",
		a.forbitcomment AS "forbitcomment",
		a.forbidforward AS "forbidforward",
		a.createtime AS "createtime",
		a.readnum AS "readnum",
		a.speakid AS "speakid",
		a.delflag AS "delflag"
	</sql>
	
	<sql id="socialForwardJoins">
	</sql>
    
	<select id="get" resultType="SocialForward">
		SELECT 
			<include refid="socialForwardColumns"/>
		FROM social_forward a
		<include refid="socialForwardJoins"/>
		WHERE a.id = #{id}
	</select>
	
	<select id="findList" resultType="SocialForward">
		SELECT 
			<include refid="socialForwardColumns"/>
		FROM social_forward a
		<include refid="socialForwardJoins"/>
		<where>
			
			<if test="id != null and id != ''">
				AND a.id = #{id}
			</if>
			<if test="userid != null and userid != ''">
				AND a.userid = #{userid}
			</if>
			<if test="subjectid != null and subjectid != ''">
				AND a.subjectid = #{subjectid}
			</if>
			<if test="tag != null and tag != ''">
				AND a.tag = #{tag}
			</if>
			<if test="reason != null and reason != ''">
				AND a.reason = #{reason}
			</if>
			<if test="visrange != null and visrange != ''">
				AND a.visrange = #{visrange}
			</if>
			<if test="forbitcomment != null and forbitcomment != ''">
				AND a.forbitcomment = #{forbitcomment}
			</if>
			<if test="forbidforward != null and forbidforward != ''">
				AND a.forbidforward = #{forbidforward}
			</if>
			<if test="createtime != null and createtime != ''">
				AND a.createtime = #{createtime}
			</if>
			<if test="readnum != null and readnum != ''">
				AND a.readnum = #{readnum}
			</if>
			<if test="speakid != null and speakid != ''">
				AND a.speakid = #{speakid}
			</if>
			<if test="delflag != null and delflag != ''">
				AND a.delflag = #{delflag}
			</if>
		</where>
		<choose>
			<when test="page !=null and page.orderBy != null and page.orderBy != ''">
				ORDER BY ${page.orderBy}
			</when>
			<otherwise>
			</otherwise>
		</choose>
	</select>
	
	<select id="findBySpeakId" resultType="SocialForward">
		SELECT 
			<include refid="socialForwardColumns"/>, su.name AS username
		FROM social_forward a, sys_user su
		<include refid="socialForwardJoins"/>
		<where>
			a.speakid = '${speakid}' AND a.userid = su.id AND delflag = '1'
		</where>
	</select>
	
	<select id="findAllList" resultType="SocialForward">
		SELECT 
			<include refid="socialForwardColumns"/>
		FROM social_forward a
		<include refid="socialForwardJoins"/>
		<where>
			
		</where>		
		<choose>
			<when test="page !=null and page.orderBy != null and page.orderBy != ''">
				ORDER BY ${page.orderBy}
			</when>
			<otherwise>
			</otherwise>
		</choose>
	</select>
	
	<insert id="insert">
		INSERT INTO social_forward(
			id,
			userid,
			subjectid,
			tag,
			reason,
			visrange,
			forbitcomment,
			forbidforward,
			createtime,
			readnum,
			speakid,
			delflag
		) VALUES (
			#{id},
			#{userid},
			#{subjectid},
			#{tag},
			#{reason},
			#{visrange},
			#{forbitcomment},
			#{forbidforward},
			#{createtime},
			#{readnum},
			#{speakid},
			#{delflag}
		)
	</insert>
	
	<update id="update">
		UPDATE social_forward SET 	
			userid = #{userid},
			subjectid = #{subjectid},
			tag = #{tag},
			reason = #{reason},
			visrange = #{visrange},
			forbitcomment = #{forbitcomment},
			forbidforward = #{forbidforward},
			createtime = #{createtime},
			readnum = #{readnum},
			speakid = #{speakid},
			delflag = #{delflag}
		WHERE id = #{id}
	</update>
	
	<update id="delete">
		DELETE FROM social_forward
		WHERE id = #{id}
	</update>
	
	<update id="changeDelFlag">
		UPDATE social_forward SET
			delflag = #{delflag}
		WHERE id = #{id}
	</update>
	
</mapper>